---
title: "Loom CLI API Specification"
generated: 2025-01-03T14:30:00Z
status: draft
level: L3
---

# Loom CLI L3 API Specification

## Overview

This document specifies the OpenAPI specification structure generated by derive-l3.

**Traceability:** Derived from [tech-specs.md](../l2/tech-specs.md) and [interface-contracts.md](../l2/interface-contracts.md).

---

## API Specification Structure

### API-001: APISpec Entity

**File:** `cmd/derive_l3.go`

```go
type APISpec struct {
    OpenAPI string                 `json:"openapi"`
    Info    map[string]interface{} `json:"info"`
    Paths   map[string]interface{} `json:"paths"`
}
```

---

## Output Format

### OUT-001: openapi.json

**File:** `{output-dir}/openapi.json`

**OpenAPI Version:** 3.0.x

**Structure:**
```json
{
  "openapi": "3.0.3",
  "info": {
    "title": "API Title",
    "version": "1.0.0",
    "description": "API description"
  },
  "paths": {
    "/orders": {
      "post": {
        "operationId": "createOrder",
        "summary": "Create a new order",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/CreateOrderRequest" }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Order created",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Order" }
              }
            }
          },
          "400": {
            "description": "Invalid request"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Order": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "status": { "type": "string" }
        }
      }
    }
  }
}
```

---

## Generation Process

### SEQ-API-001: API Specification Generation

**Input:** `tech-specs.md` (L2)

**Prompt:** Uses `prompts.DeriveL3API`

**Process:**
1. Read tech specs from L2
2. Generate OpenAPI spec via Claude
3. Parse and validate JSON structure
4. Write to openapi.json

**Output:** `openapi.json`

---

## Endpoint Patterns

### PATH-001: Resource Endpoints

| Pattern | Method | Purpose |
|---------|--------|---------|
| `/{resource}` | GET | List resources |
| `/{resource}` | POST | Create resource |
| `/{resource}/{id}` | GET | Get single resource |
| `/{resource}/{id}` | PUT | Update resource |
| `/{resource}/{id}` | DELETE | Delete resource |

### PATH-002: Action Endpoints

| Pattern | Method | Purpose |
|---------|--------|---------|
| `/{resource}/{id}/{action}` | POST | Execute action on resource |

---

## Related Documents

| Level | Document | Description |
|-------|----------|-------------|
| L0 | [decisions.md](../l0/decisions.md) | Design Decisions (L0→L1) |
| L1 | [decisions.md](../l1/decisions.md) | Design Decisions (L1→L2) |
| L2 | [decisions.md](../l2/decisions.md) | Design Decisions (L2→L3) |
| L2 | [tech-specs.md](../l2/tech-specs.md) | Technical Specifications (source) |
| L2 | [interface-contracts.md](../l2/interface-contracts.md) | CLI Interface Contract |
| L3 | [test-cases.md](test-cases.md) | Test Cases Specification |
| L3 | This document | API Specification |
| L3 | [implementation-skeletons.md](implementation-skeletons.md) | Implementation Skeletons |
